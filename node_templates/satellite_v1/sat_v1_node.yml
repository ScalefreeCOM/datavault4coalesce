capitalized: Satellite v1
short: 'SAT_v1'
plural: 'Satellites'
tagColor: '#627DE9'

config:
- groupName: Options
  items:
  - type: materializationSelector
    isRequired: true
    enableIf: 'true'
    default: view
    options:
    - view

- groupName: Data Vault
  items:
  - displayName: Hashkey Column
    type: columnSelector
    attributeName: is_hk
    isRequired: true

  - displayName: LDTS Column
    type: columnSelector
    attributeName: is_ldts
    isRequired: true

- groupName: Pre/Post SQL
  items:
  - displayName: Pre-SQL
    attributeName: preSQL
    type: textBox
    isRequired: false

  - displayName: Post-SQL
    attributeName: postSQL
    type: textBox
    isRequired: false

systemColumns:
- displayName: "ledts"
  transform: COALESCE(LEAD("{{ get_value_by_column_attribute("is_ldts") }}" - INTERVAL '1 MICROSECOND') OVER (PARTITION BY "{{ get_value_by_column_attribute("is_hk") }}" ORDER BY "{{ get_value_by_column_attribute("is_ldts") }}"),{{ datavault4coalesce__string_to_timestamp(parameters.datavault4coalesce__timestamp_format, parameters.datavault4coalesce__end_of_all_times) }})
  dataType: TIMESTAMP
  placement: end
  attributeName: is_system_ledts