fileVersion: 1
id: Databricks get source ma keys
macroString: |- 

  {#-------------------------------------------------------------------------#}
  {#-- Outputs list of multi-active keys from the direct parent object     --#}
  {#-- Usage: Node definition of multi-active satellite v1                 --#}
  {#--   delimiter: delimiter character to be used in string concatenation --#}
  {#-------------------------------------------------------------------------#}
  {%- macro datavault4coalesce__databricks_get_source_ma_keys(delimiter=',') -%}
       {%- set srcCols = sources[0].dependencies[0].columns -%}
       {%- set result = [] -%}
       {% for srcMAKey in srcCols if srcMAKey.is_ma_key %}
            {%- set result = result.append(srcMAKey.name) -%}
       {%- endfor -%}
       {{- result|join(delimiter) -}}
  {%- endmacro -%}
name: datavault4coalesce__databricks_get_source_ma_keys
type: Macro