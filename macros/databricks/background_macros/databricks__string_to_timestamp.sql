
{#-- Utility macro: outputs a SQL function to convert input string into a timestamp of dynamic format. --#}
{%- macro datavault4coalesce__databricks_string_to_timestamp(format, timestamp) -%}
  {%- set new_format = format | replace('"', '') -%}
  {%- set new_timestamp =  timestamp | replace('"', '') -%}
  TO_TIMESTAMP('{{ new_timestamp }}', '{{ new_format }}')
{%- endmacro -%}